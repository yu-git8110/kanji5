<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>漢検5級 一文字書き取り</title>
  <style>
    :root {
      --pad: 14px;
      --radius: 16px;
      --btnH: 52px;
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Hiragino Sans", "Noto Sans JP", "Segoe UI", Roboto, Arial, sans-serif;
      background: #f6f7f9;
      color: #111;
    }
    .wrap {
      padding: calc(env(safe-area-inset-top) + var(--pad)) var(--pad) calc(env(safe-area-inset-bottom) + var(--pad)) var(--pad);
      max-width: 720px;
      margin: 0 auto;
    }
    .card {
      background: #fff;
      border-radius: var(--radius);
      box-shadow: 0 6px 20px rgba(0,0,0,.08);
      padding: 14px;
      margin-bottom: 12px;
    }
    .top {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
    }
    .title {
      font-size: 15px;
      opacity: .7;
    }
    .counter {
      font-size: 13px;
      opacity: .7;
    }
    .yomi {
      font-size: 38px;
      font-weight: 800;
      letter-spacing: .02em;
      margin: 10px 0 2px 0;
      line-height: 1.05;
      word-break: keep-all;
      text-align: center;
    }
    .hint {
      font-size: 12px;
      opacity: .6;
      text-align: center;
      margin-bottom: 4px;
    }
    .canvasWrap {
      background: #fff;
      border-radius: var(--radius);
      overflow: hidden;
      border: 1px solid rgba(0,0,0,.12);
    }
    canvas {
      width: 100%;
      height: min(52vh, 420px);
      display: block;
      touch-action: none;
      background: #fff;
    }
    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    button {
      height: var(--btnH);
      border: 0;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 700;
      background: #111;
      color: #fff;
      cursor: pointer;
    }
    button.secondary {
      background: #e9eaee;
      color: #111;
      font-weight: 800;
    }
    button:active {
      transform: scale(.99);
    }
    .answer {
      display: none;
      margin-top: 12px;
      text-align: center;
    }
    .answer .label {
      font-size: 13px;
      opacity: .65;
      margin-bottom: 4px;
    }
    .answer .kanji {
      font-size: 96px;
      font-weight: 900;
      line-height: 1;
      padding: 8px 0;
    }
    .footer {
      text-align: center;
      font-size: 12px;
      opacity: .6;
      margin-top: 10px;
    }
    .pill {
      display: inline-block;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(17,17,17,.06);
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="title">漢検5級 一文字書き取り（iPhone版）</div>
        <div class="counter" id="counter">-</div>
      </div>

      <div class="yomi" id="yomi">読み込み中…</div>
      <div class="hint">よみ を見て、下に漢字を手書き</div>
    </div>

    <div class="canvasWrap">
      <canvas id="pad"></canvas>
    </div>

    <div class="row">
      <button class="secondary" id="clearBtn">消す</button>
      <button id="showBtn">答えを見る</button>
    </div>

    <div class="row" style="grid-template-columns: 1fr;">
      <button class="secondary" id="nextBtn">次の問題（ランダム）</button>
    </div>

    <div class="card answer" id="answerBox">
      <div class="label">答え</div>
      <div class="kanji" id="answerKanji">—</div>
      <div class="pill" id="answerYomi">—</div>
    </div>

    <div class="footer">
      492問（全読み×漢字） / 自己採点式<br>
      ※ iPhoneはSafari推奨
    </div>
  </div>

<script>
  const QUESTIONS = [{"yomi": "あう", "kanji": "値"}, {"yomi": "あかい", "kanji": "紅"}, {"yomi": "あきらか", "kanji": "朗"}, {"yomi": "あげつらう", "kanji": "論"}, {"yomi": "あずかる", "kanji": "預"}, {"yomi": "あずける", "kanji": "預"}, {"yomi": "あだ", "kanji": "敵"}, {"yomi": "あたい", "kanji": "値"}, {"yomi": "あたたか", "kanji": "暖"}, {"yomi": "ある", "kanji": "存"}, {"yomi": "い", "kanji": "胃"}, {"yomi": "い", "kanji": "異"}, {"yomi": "い", "kanji": "遺"}, {"yomi": "いえ", "kanji": "宇"}, {"yomi": "いえ", "kanji": "宅"}, {"yomi": "いかつい", "kanji": "厳"}, {"yomi": "いかめしい", "kanji": "厳"}, {"yomi": "いき", "kanji": "域"}, {"yomi": "いきおい", "kanji": "権"}, {"yomi": "いさご", "kanji": "砂"}, {"yomi": "いずみ", "kanji": "泉"}, {"yomi": "いそしむ", "kanji": "勤"}, {"yomi": "いたい", "kanji": "痛"}, {"yomi": "いただき", "kanji": "頂"}, {"yomi": "いただく", "kanji": "頂"}, {"yomi": "いたむ", "kanji": "痛"}, {"yomi": "いたむ", "kanji": "傷"}, {"yomi": "います", "kanji": "座"}, {"yomi": "いや", "kanji": "否"}, {"yomi": "いる", "kanji": "射"}, {"yomi": "いれる", "kanji": "納"}, {"yomi": "う", "kanji": "宇"}, {"yomi": "う", "kanji": "優"}, {"yomi": "うえる", "kanji": "樹"}, {"yomi": "うけたまわ", "kanji": "承"}, {"yomi": "うける", "kanji": "承"}, {"yomi": "うしお", "kanji": "潮"}, {"yomi": "うしなう", "kanji": "亡"}, {"yomi": "うしろ", "kanji": "背"}, {"yomi": "うたがう", "kanji": "疑"}, {"yomi": "うたぐる", "kanji": "疑"}, {"yomi": "うち", "kanji": "裏"}, {"yomi": "うつ", "kanji": "批"}, {"yomi": "うつ", "kanji": "射"}, {"yomi": "うつ", "kanji": "討"}, {"yomi": "うつす", "kanji": "映"}, {"yomi": "うつる", "kanji": "映"}, {"yomi": "うまれる", "kanji": "誕"}, {"yomi": "うむ", "kanji": "熟"}, {"yomi": "うやまう", "kanji": "敬"}, {"yomi": "うら", "kanji": "裏"}, {"yomi": "うれる", "kanji": "熟"}, {"yomi": "えい", "kanji": "映"}, {"yomi": "えき", "kanji": "射"}, {"yomi": "おぎなう", "kanji": "補"}, {"yomi": "おく", "kanji": "処"}, {"yomi": "おごそか", "kanji": "厳"}, {"yomi": "おさない", "kanji": "幼"}, {"yomi": "おさまる", "kanji": "収"}, {"yomi": "おさまる", "kanji": "納"}, {"yomi": "おさめる", "kanji": "収"}, {"yomi": "おさめる", "kanji": "納"}, {"yomi": "おさめる", "kanji": "蔵"}, {"yomi": "きさき", "kanji": "后"}, {"yomi": "きざはし", "kanji": "段"}, {"yomi": "きざはし", "kanji": "陛"}, {"yomi": "きざむ", "kanji": "刻"}, {"yomi": "きず", "kanji": "創"}, {"yomi": "きず", "kanji": "傷"}, {"yomi": "きぬ", "kanji": "絹"}, {"yomi": "きびしい", "kanji": "厳"}, {"yomi": "きみ", "kanji": "后"}, {"yomi": "くら", "kanji": "蔵"}, {"yomi": "くらす", "kanji": "暮"}, {"yomi": "くるしむ", "kanji": "困"}, {"yomi": "くれ", "kanji": "晩"}, {"yomi": "くれない", "kanji": "紅"}, {"yomi": "くれる", "kanji": "暮"}, {"yomi": "け", "kanji": "灰"}, {"yomi": "けい", "kanji": "系"}, {"yomi": "けい", "kanji": "敬"}, {"yomi": "こう", "kanji": "后"}, {"yomi": "こう", "kanji": "孝"}, {"yomi": "こう", "kanji": "皇"}, {"yomi": "こう", "kanji": "紅"}, {"yomi": "こう", "kanji": "降"}, {"yomi": "こう", "kanji": "鋼"}, {"yomi": "ごう", "kanji": "降"}, {"yomi": "ごう", "kanji": "郷"}, {"yomi": "こく", "kanji": "刻"}, {"yomi": "こなれる", "kanji": "熟"}, {"yomi": "こまかい", "kanji": "密"}, {"yomi": "こまる", "kanji": "困"}, {"yomi": "こん", "kanji": "困"}, {"yomi": "ごん", "kanji": "勤"}, {"yomi": "ごん", "kanji": "権"}, {"yomi": "ごん", "kanji": "厳"}, {"yomi": "さ", "kanji": "砂"}, {"yomi": "ざ", "kanji": "座"}, {"yomi": "さい", "kanji": "済"}, {"yomi": "さい", "kanji": "裁"}, {"yomi": "さかい", "kanji": "域"}, {"yomi": "さがす", "kanji": "探"}, {"yomi": "さかる", "kanji": "盛"}, {"yomi": "さかん", "kanji": "盛"}, {"yomi": "さく", "kanji": "冊"}, {"yomi": "さく", "kanji": "策"}, {"yomi": "さく", "kanji": "割"}, {"yomi": "さぐる", "kanji": "探"}, {"yomi": "さし", "kanji": "尺"}, {"yomi": "さす", "kanji": "射"}, {"yomi": "さつ", "kanji": "冊"}, {"yomi": "さと", "kanji": "郷"}, {"yomi": "さばく", "kanji": "裁"}, {"yomi": "さわる", "kanji": "障"}, {"yomi": "しで", "kanji": "垂"}, {"yomi": "しまる", "kanji": "閉"}, {"yomi": "しみ", "kanji": "染"}, {"yomi": "しみる", "kanji": "染"}, {"yomi": "しめる", "kanji": "閉"}, {"yomi": "しゃ", "kanji": "砂"}, {"yomi": "しゃ", "kanji": "射"}, {"yomi": "しゃ", "kanji": "捨"}, {"yomi": "じゃ", "kanji": "若"}, {"yomi": "しゃく", "kanji": "尺"}, {"yomi": "じゃく", "kanji": "若"}, {"yomi": "じゃく", "kanji": "著"}, {"yomi": "しゅ", "kanji": "株"}, {"yomi": "しゅ", "kanji": "衆"}, {"yomi": "じゅ", "kanji": "乳"}, {"yomi": "じゅ", "kanji": "従"}, {"yomi": "じゅ", "kanji": "就"}, {"yomi": "じゅ", "kanji": "樹"}, {"yomi": "しゅう", "kanji": "収"}, {"yomi": "しゅう", "kanji": "宗"}, {"yomi": "しゅう", "kanji": "衆"}, {"yomi": "しゅう", "kanji": "就"}, {"yomi": "じゅう", "kanji": "従"}, {"yomi": "じゅう", "kanji": "縦"}, {"yomi": "しゅく", "kanji": "縮"}, {"yomi": "じゅく", "kanji": "熟"}, {"yomi": "しゅくば", "kanji": "郵"}, {"yomi": "じゅん", "kanji": "純"}, {"yomi": "しょ", "kanji": "処"}, {"yomi": "しょ", "kanji": "署"}, {"yomi": "しょ", "kanji": "諸"}, {"yomi": "じょ", "kanji": "除"}, {"yomi": "しょう", "kanji": "承"}, {"yomi": "しょう", "kanji": "従"}, {"yomi": "しょう", "kanji": "将"}, {"yomi": "しょう", "kanji": "装"}, {"yomi": "しょう", "kanji": "傷"}, {"yomi": "しょう", "kanji": "聖"}, {"yomi": "しょう", "kanji": "障"}, {"yomi": "しょう", "kanji": "縦"}, {"yomi": "じょう", "kanji": "盛"}, {"yomi": "じょう", "kanji": "蒸"}, {"yomi": "じょう", "kanji": "誠"}, {"yomi": "しりぞく", "kanji": "退"}, {"yomi": "しりぞける", "kanji": "退"}, {"yomi": "しるす", "kanji": "署"}, {"yomi": "しるす", "kanji": "誌"}, {"yomi": "しん", "kanji": "針"}, {"yomi": "じん", "kanji": "仁"}, {"yomi": "じん", "kanji": "賃"}, {"yomi": "じん", "kanji": "認"}, {"yomi": "すい", "kanji": "垂"}, {"yomi": "すい", "kanji": "推"}, {"yomi": "すう", "kanji": "吸"}, {"yomi": "すがた", "kanji": "姿"}, {"yomi": "すき", "kanji": "銭"}, {"yomi": "すくう", "kanji": "済"}, {"yomi": "すぐれる", "kanji": "優"}, {"yomi": "すさる", "kanji": "退"}, {"yomi": "すじ", "kanji": "系"}, {"yomi": "すじ", "kanji": "筋"}, {"yomi": "すすめる", "kanji": "奏"}, {"yomi": "すてる", "kanji": "捨"}, {"yomi": "ぜに", "kanji": "銭"}, {"yomi": "せん", "kanji": "専"}, {"yomi": "せん", "kanji": "宣"}, {"yomi": "せん", "kanji": "染"}, {"yomi": "せん", "kanji": "泉"}, {"yomi": "せん", "kanji": "洗"}, {"yomi": "せん", "kanji": "善"}, {"yomi": "せん", "kanji": "銭"}, {"yomi": "ぜん", "kanji": "染"}, {"yomi": "ぜん", "kanji": "善"}, {"yomi": "ぜん", "kanji": "銭"}, {"yomi": "そ", "kanji": "処"}, {"yomi": "そう", "kanji": "宗"}, {"yomi": "そう", "kanji": "奏"}, {"yomi": "そう", "kanji": "窓"}, {"yomi": "そう", "kanji": "装"}, {"yomi": "そう", "kanji": "創"}, {"yomi": "そう", "kanji": "層"}, {"yomi": "そう", "kanji": "蔵"}, {"yomi": "そう", "kanji": "操"}, {"yomi": "そう", "kanji": "臓"}, {"yomi": "そう", "kanji": "沿"}, {"yomi": "ぞう", "kanji": "蔵"}, {"yomi": "ぞう", "kanji": "臓"}, {"yomi": "そこなう", "kanji": "傷"}, {"yomi": "そなえる", "kanji": "供"}, {"yomi": "そまる", "kanji": "染"}, {"yomi": "だ", "kanji": "難"}, {"yomi": "たい", "kanji": "退"}, {"yomi": "たかい", "kanji": "危"}, {"yomi": "たかい", "kanji": "貴"}, {"yomi": "たかどの", "kanji": "閣"}, {"yomi": "たから", "kanji": "宝"}, {"yomi": "たからか", "kanji": "朗"}, {"yomi": "たく", "kanji": "宅"}, {"yomi": "たすける", "kanji": "補"}, {"yomi": "たて", "kanji": "縦"}, {"yomi": "たてる", "kanji": "冊"}, {"yomi": "たてる", "kanji": "閉"}, {"yomi": "たてる", "kanji": "樹"}, {"yomi": "たな", "kanji": "閣"}, {"yomi": "たまご", "kanji": "卵"}, {"yomi": "たもつ", "kanji": "存"}, {"yomi": "たらす", "kanji": "垂"}, {"yomi": "たれる", "kanji": "垂"}, {"yomi": "たわむれ", "kanji": "俳"}, {"yomi": "たわら", "kanji": "俵"}, {"yomi": "たん", "kanji": "担"}, {"yomi": "たん", "kanji": "段"}, {"yomi": "たん", "kanji": "探"}, {"yomi": "たん", "kanji": "誕"}, {"yomi": "だん", "kanji": "段"}, {"yomi": "だん", "kanji": "暖"}, {"yomi": "だん", "kanji": "難"}, {"yomi": "ち", "kanji": "値"}, {"yomi": "ち", "kanji": "乳"}, {"yomi": "ちかう", "kanji": "盟"}, {"yomi": "ちち", "kanji": "乳"}, {"yomi": "ちぢまる", "kanji": "縮"}, {"yomi": "ちぢむ", "kanji": "縮"}, {"yomi": "ちぢめる", "kanji": "縮"}, {"yomi": "ちぢらす", "kanji": "縮"}, {"yomi": "ちぢれる", "kanji": "縮"}, {"yomi": "ちゃく", "kanji": "著"}, {"yomi": "ちゅう", "kanji": "宙"}, {"yomi": "ちゅう", "kanji": "忠"}, {"yomi": "ちょ", "kanji": "著"}, {"yomi": "ちょう", "kanji": "庁"}, {"yomi": "ちょう", "kanji": "頂"}, {"yomi": "ちょう", "kanji": "腸"}, {"yomi": "ちょう", "kanji": "潮"}, {"yomi": "ちょく", "kanji": "値"}, {"yomi": "ちん", "kanji": "賃"}, {"yomi": "つう", "kanji": "痛"}, {"yomi": "つえ", "kanji": "策"}, {"yomi": "つかわす", "kanji": "派"}, {"yomi": "つきる", "kanji": "除"}, {"yomi": "つく", "kanji": "著"}, {"yomi": "つく", "kanji": "就"}, {"yomi": "つくえ", "kanji": "机"}, {"yomi": "つくづく", "kanji": "熟"}, {"yomi": "つらねる", "kanji": "展"}, {"yomi": "てい", "kanji": "庁"}, {"yomi": "てい", "kanji": "頂"}, {"yomi": "てがた", "kanji": "券"}, {"yomi": "てき", "kanji": "敵"}, {"yomi": "てん", "kanji": "蚕"}, {"yomi": "てん", "kanji": "展"}, {"yomi": "とう", "kanji": "党"}, {"yomi": "とう", "kanji": "討"}, {"yomi": "とう", "kanji": "納"}, {"yomi": "とう", "kanji": "痛"}, {"yomi": "とう", "kanji": "糖"}, {"yomi": "とう", "kanji": "存"}, {"yomi": "とう", "kanji": "訪"}, {"yomi": "どう", "kanji": "脳"}, {"yomi": "とうとい", "kanji": "貴"}, {"yomi": "とうとい", "kanji": "尊"}, {"yomi": "とうとぶ", "kanji": "貴"}, {"yomi": "とうとぶ", "kanji": "尊"}, {"yomi": "とき", "kanji": "刻"}, {"yomi": "とく", "kanji": "訳"}, {"yomi": "とく", "kanji": "論"}, {"yomi": "ところ", "kanji": "処"}, {"yomi": "ところ", "kanji": "域"}, {"yomi": "とざす", "kanji": "閉"}, {"yomi": "とじる", "kanji": "閉"}, {"yomi": "とどく", "kanji": "届"}, {"yomi": "とどける", "kanji": "届"}, {"yomi": "とも", "kanji": "供"}, {"yomi": "とる", "kanji": "操"}, {"yomi": "とん", "kanji": "純"}, {"yomi": "な", "kanji": "納"}, {"yomi": "な", "kanji": "難"}, {"yomi": "ない", "kanji": "亡"}, {"yomi": "なかま", "kanji": "党"}, {"yomi": "ながらえる", "kanji": "存"}, {"yomi": "なす", "kanji": "済"}, {"yomi": "なす", "kanji": "就"}, {"yomi": "なっ", "kanji": "納"}, {"yomi": "なみ", "kanji": "並"}, {"yomi": "ならびに", "kanji": "並"}, {"yomi": "ならぶ", "kanji": "並"}, {"yomi": "ならべる", "kanji": "並"}, {"yomi": "なる", "kanji": "就"}, {"yomi": "なれる", "kanji": "熟"}, {"yomi": "なん", "kanji": "納"}, {"yomi": "なん", "kanji": "難"}, {"yomi": "なんじ", "kanji": "若"}, {"yomi": "なんなんとする", "kanji": "垂"}, {"yomi": "に", "kanji": "仁"}, {"yomi": "にえる", "kanji": "熟"}, {"yomi": "にくい", "kanji": "難"}, {"yomi": "にげる", "kanji": "亡"}, {"yomi": "になう", "kanji": "担"}, {"yomi": "にゃ", "kanji": "若"}, {"yomi": "にゃく", "kanji": "若"}, {"yomi": "にゅ", "kanji": "乳"}, {"yomi": "にゅう", "kanji": "乳"}, {"yomi": "にる", "kanji": "熟"}, {"yomi": "にん", "kanji": "仁"}, {"yomi": "にん", "kanji": "認"}, {"yomi": "ね", "kanji": "値"}, {"yomi": "のう", "kanji": "納"}, {"yomi": "のう", "kanji": "脳"}, {"yomi": "のき", "kanji": "宇"}, {"yomi": "のく", "kanji": "退"}, {"yomi": "のける", "kanji": "退"}, {"yomi": "のける", "kanji": "除"}, {"yomi": "のこす", "kanji": "遺"}, {"yomi": "のこる", "kanji": "遺"}, {"yomi": "のぞく", "kanji": "除"}, {"yomi": "のぞむ", "kanji": "臨"}, {"yomi": "のたまう", "kanji": "宣"}, {"yomi": "のち", "kanji": "后"}, {"yomi": "のっとる", "kanji": "律"}, {"yomi": "のっとる", "kanji": "模"}, {"yomi": "のっとる", "kanji": "憲"}, {"yomi": "のばす", "kanji": "延"}, {"yomi": "のびる", "kanji": "延"}, {"yomi": "のべる", "kanji": "延"}, {"yomi": "のべる", "kanji": "宣"}, {"yomi": "のべる", "kanji": "展"}, {"yomi": "のり", "kanji": "律"}, {"yomi": "のり", "kanji": "憲"}, {"yomi": "のん", "kanji": "暖"}, {"yomi": "は", "kanji": "派"}, {"yomi": "はい", "kanji": "拝"}, {"yomi": "はい", "kanji": "派"}, {"yomi": "はい", "kanji": "肺"}, {"yomi": "はい", "kanji": "背"}, {"yomi": "はい", "kanji": "俳"}, {"yomi": "はい", "kanji": "灰"}, {"yomi": "ばい", "kanji": "枚"}, {"yomi": "はえ", "kanji": "延"}, {"yomi": "はえる", "kanji": "映"}, {"yomi": "はがね", "kanji": "鋼"}, {"yomi": "はかりごと", "kanji": "策"}, {"yomi": "はかる", "kanji": "権"}, {"yomi": "ばく", "kanji": "幕"}, {"yomi": "はげしい", "kanji": "劇"}, {"yomi": "はげしい", "kanji": "激"}, {"yomi": "はげます", "kanji": "激"}, {"yomi": "はじめる", "kanji": "創"}, {"yomi": "はた", "kanji": "将"}, {"yomi": "はなつ", "kanji": "縦"}, {"yomi": "はやす", "kanji": "映"}, {"yomi": "はら", "kanji": "腹"}, {"yomi": "はらう", "kanji": "除"}, {"yomi": "はらわた", "kanji": "腸"}, {"yomi": "はらわた", "kanji": "臓"}, {"yomi": "はり", "kanji": "針"}, {"yomi": "はん", "kanji": "班"}, {"yomi": "ばん", "kanji": "晩"}, {"yomi": "ひ", "kanji": "否"}, {"yomi": "ひ", "kanji": "批"}, {"yomi": "ひ", "kanji": "秘"}, {"yomi": "ひきいる", "kanji": "将"}, {"yomi": "ひく", "kanji": "延"}, {"yomi": "ひく", "kanji": "退"}, {"yomi": "ひじり", "kanji": "聖"}, {"yomi": "ひそか", "kanji": "私"}, {"yomi": "ひろげる", "kanji": "拡"}, {"yomi": "ひろげる", "kanji": "展"}, {"yomi": "ふ", "kanji": "否"}, {"yomi": "ふ", "kanji": "補"}, {"yomi": "ぶ", "kanji": "亡"}, {"yomi": "ふかす", "kanji": "蒸"}, {"yomi": "ふく", "kanji": "腹"}, {"yomi": "ふける", "kanji": "蒸"}, {"yomi": "ふせぐ", "kanji": "障"}, {"yomi": "ふだ", "kanji": "策"}, {"yomi": "ふだ", "kanji": "簡"}, {"yomi": "ふち", "kanji": "沿"}, {"yomi": "ふみ", "kanji": "冊"}, {"yomi": "ふる", "kanji": "降"}, {"yomi": "ふるう", "kanji": "揮"}, {"yomi": "ふるう", "kanji": "奮"}, {"yomi": "ふん", "kanji": "奮"}, {"yomi": "へい", "kanji": "並"}, {"yomi": "ほう", "kanji": "宝"}, {"yomi": "ほう", "kanji": "訪"}, {"yomi": "ほう", "kanji": "棒"}, {"yomi": "ぼう", "kanji": "亡"}, {"yomi": "ぼう", "kanji": "忘"}, {"yomi": "ぼう", "kanji": "棒"}, {"yomi": "ほがらか", "kanji": "朗"}, {"yomi": "ほしい", "kanji": "欲"}, {"yomi": "ほしいまま", "kanji": "専"}, {"yomi": "まい", "kanji": "枚"}, {"yomi": "まき", "kanji": "巻"}, {"yomi": "まく", "kanji": "幕"}, {"yomi": "まく", "kanji": "巻"}, {"yomi": "まごころ", "kanji": "忠"}, {"yomi": "まこと", "kanji": "誠"}, {"yomi": "まさに", "kanji": "将"}, {"yomi": "まさる", "kanji": "優"}, {"yomi": "まど", "kanji": "窓"}, {"yomi": "まどわす", "kanji": "誤"}, {"yomi": "みこと", "kanji": "尊"}, {"yomi": "みさお", "kanji": "操"}, {"yomi": "みだす", "kanji": "乱"}, {"yomi": "みだりに", "kanji": "乱"}, {"yomi": "みだれる", "kanji": "乱"}, {"yomi": "みち", "kanji": "密"}, {"yomi": "みつ", "kanji": "密"}, {"yomi": "みとめる", "kanji": "認"}, {"yomi": "みなもと", "kanji": "源"}, {"yomi": "みる", "kanji": "看"}, {"yomi": "みる", "kanji": "視"}, {"yomi": "みる", "kanji": "覧"}, {"yomi": "む", "kanji": "亡"}, {"yomi": "むす", "kanji": "蒸"}, {"yomi": "むずかしい", "kanji": "難"}, {"yomi": "むち", "kanji": "策"}, {"yomi": "むつかしい", "kanji": "難"}, {"yomi": "むな", "kanji": "胸"}, {"yomi": "むね", "kanji": "宗"}, {"yomi": "むね", "kanji": "胸"}, {"yomi": "むら", "kanji": "党"}, {"yomi": "むらす", "kanji": "蒸"}, {"yomi": "むれる", "kanji": "蒸"}, {"yomi": "めい", "kanji": "盟"}, {"yomi": "めぐみ", "kanji": "恩"}, {"yomi": "も", "kanji": "模"}, {"yomi": "や", "kanji": "射"}, {"yomi": "やきもの", "kanji": "磁"}, {"yomi": "やく", "kanji": "訳"}, {"yomi": "やくわり", "kanji": "署"}, {"yomi": "やけ", "kanji": "宅"}, {"yomi": "やさしい", "kanji": "優"}, {"yomi": "やとう", "kanji": "賃"}, {"yomi": "やめる", "kanji": "痛"}, {"yomi": "やわらぐ", "kanji": "優"}, {"yomi": "ゆ", "kanji": "郵"}, {"yomi": "ゆい", "kanji": "遺"}, {"yomi": "ゆう", "kanji": "幼"}, {"yomi": "ゆう", "kanji": "郵"}, {"yomi": "ゆう", "kanji": "優"}, {"yomi": "ゆたか", "kanji": "優"}, {"yomi": "ゆるす", "kanji": "縦"}, {"yomi": "ゆるめる", "kanji": "縦"}, {"yomi": "よ", "kanji": "預"}, {"yomi": "よい", "kanji": "善"}, {"yomi": "よう", "kanji": "幼"}, {"yomi": "よく", "kanji": "域"}, {"yomi": "よく", "kanji": "翌"}, {"yomi": "よく", "kanji": "欲"}, {"yomi": "よける", "kanji": "除"}, {"yomi": "よしんば", "kanji": "縦"}, {"yomi": "よそう", "kanji": "装"}, {"yomi": "よそおう", "kanji": "装"}, {"yomi": "らん", "kanji": "卵"}, {"yomi": "らん", "kanji": "乱"}, {"yomi": "らん", "kanji": "覧"}, {"yomi": "り", "kanji": "裏"}, {"yomi": "りち", "kanji": "律"}, {"yomi": "りつ", "kanji": "律"}, {"yomi": "りん", "kanji": "臨"}, {"yomi": "ろう", "kanji": "朗"}, {"yomi": "ろん", "kanji": "乱"}, {"yomi": "わすれる", "kanji": "忘"}, {"yomi": "わすれる", "kanji": "遺"}, {"yomi": "わた", "kanji": "腸"}, {"yomi": "わたくし", "kanji": "私"}, {"yomi": "わたし", "kanji": "私"}, {"yomi": "わたす", "kanji": "済"}, {"yomi": "わたる", "kanji": "済"}, {"yomi": "わり", "kanji": "割"}, {"yomi": "わりふ", "kanji": "券"}, {"yomi": "わる", "kanji": "割"}, {"yomi": "わるい", "kanji": "否"}, {"yomi": "われ", "kanji": "我"}, {"yomi": "われる", "kanji": "割"}];

  let deck = [];
  let idx = 0;
  let current = null;

  function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function resetDeck() {
    deck = shuffle(QUESTIONS.map((q, i) => i));
    idx = 0;
  }

  function setQuestion(q) {
    current = q;
    document.getElementById("yomi").textContent = q.yomi;
    document.getElementById("answerKanji").textContent = q.kanji;
    document.getElementById("answerYomi").textContent = q.yomi;
    document.getElementById("answerBox").style.display = "none";
    clearCanvas();
    updateCounter();
  }

  function updateCounter() {
    const remain = deck.length - idx;
    document.getElementById("counter").textContent = "残り " + remain + " / " + deck.length;
  }

  function nextQuestion() {
    if (!deck.length || idx >= deck.length) resetDeck();
    const q = QUESTIONS[deck[idx++]];
    setQuestion(q);
  }

  const canvas = document.getElementById("pad");
  const ctx = canvas.getContext("2d", { willReadFrequently: true });

  function resizeCanvas() {
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    const rect = canvas.getBoundingClientRect();
    canvas.width = Math.floor(rect.width * dpr);
    canvas.height = Math.floor(rect.height * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.strokeStyle = "#111";
    ctx.lineWidth = 10;
  }

  let drawing = false;
  let lastX = 0, lastY = 0;

  function getPos(e) {
    const rect = canvas.getBoundingClientRect();
    const t = e.touches ? e.touches[0] : e;
    return { x: t.clientX - rect.left, y: t.clientY - rect.top };
  }

  function startDraw(e) {
    e.preventDefault();
    drawing = true;
    const p = getPos(e);
    lastX = p.x; lastY = p.y;
  }

  function moveDraw(e) {
    if (!drawing) return;
    e.preventDefault();
    const p = getPos(e);
    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
    ctx.lineTo(p.x, p.y);
    ctx.stroke();
    lastX = p.x; lastY = p.y;
  }

  function endDraw(e) {
    if (!drawing) return;
    e.preventDefault();
    drawing = false;
  }

  function clearCanvas() {
    const rect = canvas.getBoundingClientRect();
    ctx.clearRect(0, 0, rect.width, rect.height);
  }

  document.getElementById("clearBtn").addEventListener("click", clearCanvas);
  document.getElementById("showBtn").addEventListener("click", () => {
    const box = document.getElementById("answerBox");
    box.style.display = (box.style.display === "none" || !box.style.display) ? "block" : "none";
  });
  document.getElementById("nextBtn").addEventListener("click", nextQuestion);

  canvas.addEventListener("touchstart", startDraw, { passive: false });
  canvas.addEventListener("touchmove", moveDraw, { passive: false });
  canvas.addEventListener("touchend", endDraw, { passive: false });
  canvas.addEventListener("touchcancel", endDraw, { passive: false });

  // iPadやMacでも一応動く
  canvas.addEventListener("mousedown", startDraw);
  canvas.addEventListener("mousemove", moveDraw);
  window.addEventListener("mouseup", endDraw);

  window.addEventListener("resize", () => {
    resizeCanvas();
    clearCanvas();
  });

  resetDeck();
  resizeCanvas();
  nextQuestion();
</script>
</body>
</html>
